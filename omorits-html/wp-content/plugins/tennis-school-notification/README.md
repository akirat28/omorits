# テニススクール開催連絡プラグイン

大森テニススクールの開催・中止情報を管理・表示するWordPressプラグインです。

## 概要

ホームページに訪れた人に本日のスクール開催状況を通知するためのプラグインです。
ページ内の目立つところに「本日の開催連絡」というラベルで開催の可否を通知します。

## 機能

- **カレンダー形式の日付選択**: 簡単に通知する日付を選択できます
- **3種類の表示色**:
  - 🟢 緑色: 通常連絡（開催）
  - 🟡 黄色: 注意連絡
  - 🔴 赤色: 中止連絡
- **サンプルメッセージ**: よく使うメッセージをワンクリックで挿入
- **リアルタイムプレビュー**: 入力した内容をその場で確認
- **一覧管理**: 過去の連絡履歴を一覧で確認・編集・削除
- **ショートコード対応**: ページや投稿に簡単に挿入可能

## インストール

1. このプラグインフォルダを `wp-content/plugins/` ディレクトリにアップロード
2. WordPress管理画面の「プラグイン」メニューからプラグインを有効化
3. 有効化すると自動的にデータベーステーブルが作成されます

## 使い方

### 1. 開催連絡の新規作成

1. WordPress管理画面の「開催連絡」メニューをクリック
2. 「新規追加」をクリック
3. 以下の項目を入力:
   - **日付**: カレンダーから通知日を選択
   - **表示色**: 通常連絡（緑）、注意連絡（黄）、中止連絡（赤）から選択
   - **メッセージ**: 表示するメッセージを入力（サンプルから選択可）
4. プレビューで確認後、「保存」ボタンをクリック

### 2. 開催連絡の一覧・編集・削除

1. 「開催連絡」→「通知一覧」をクリック
2. 登録済みの通知が一覧表示されます
3. **編集**: 各行の「編集」ボタンをクリック
4. **削除**: 各行の「削除」ボタンをクリック（確認ダイアログが表示されます）

### 3. フロントエンドへの表示

#### 基本的な使い方

通知を表示したいページや投稿に以下のショートコードを挿入:

```
[tennis_notification]
```

このコードを挿入すると、本日の開催連絡が自動的に表示されます。

#### ショートコードのオプション

**特定の日付の通知を表示:**
```
[tennis_notification date="2024-12-25"]
```

**今日から指定日数分の通知を表示:**
```
[tennis_notification days="14"]
```
※デフォルトは7日間

**すべての通知を表示:**
```
[tennis_notification show_all="true"]
```

## サンプルメッセージ

以下のサンプルメッセージが用意されています:

- 本日のテニススクールは開催します。
- 本日のテニススクールは雨のため中止とさせていただきます。
- 本日のテニススクールは A・Bクラスは中止とさせていただきます。
- 本日のテニススクールは強風のため中止とさせていただきます。
- 本日のテニススクールはコート整備のため中止とさせていただきます。
- 本日のテニススクールは通常通り開催します。皆様のご参加をお待ちしております。

サンプルメッセージを選択すると、日付部分が自動的に選択した日付に置き換わります。

## ページへの組み込み例

### HOMEページに表示

`page-home.php` のお知らせセクションの前に以下のコードを追加:

```php
<!-- 開催連絡 -->
<?php echo do_shortcode('[tennis_notification]'); ?>
```

### サイドバーに表示

ウィジェットエリアに「カスタムHTML」ウィジェットを追加し、以下を入力:

```html
[tennis_notification]
```

### 固定ページに表示

固定ページの編集画面で、ブロックエディタの「ショートコード」ブロックを追加し、以下を入力:

```
[tennis_notification]
```

## データベース構造

プラグインは以下のテーブルを作成します:

**テーブル名**: `wp_tennis_notifications`

| カラム名 | データ型 | 説明 |
|---------|---------|------|
| id | INT(11) | 主キー（自動採番） |
| notification_date | DATE | 通知日 |
| message | TEXT | 表示メッセージ |
| color | VARCHAR(20) | 表示色（green/yellow/red） |
| created_at | DATETIME | 作成日時 |
| updated_at | DATETIME | 更新日時 |

## ファイル構造

```
tennis-school-notification/
├── tennis-school-notification.php  # メインファイル
├── includes/
│   ├── class-database.php          # データベース操作クラス
│   ├── class-admin.php             # 管理画面クラス
│   └── class-shortcode.php         # ショートコードクラス
├── assets/
│   ├── css/
│   │   ├── frontend.css            # フロントエンド用CSS
│   │   └── admin.css               # 管理画面用CSS
│   └── js/
│       └── admin.js                # 管理画面用JavaScript
└── README.md                       # このファイル
```

## カスタマイズ

### 表示色の変更

`assets/css/frontend.css` の以下のセクションで色をカスタマイズできます:

```css
/* 緑色（通常連絡） */
.tsn-notification.tsn-green .tsn-notification-header::before {
    background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
}
```

### サンプルメッセージの追加

`includes/class-admin.php` の `display_admin_page()` メソッド内の `$sample_messages` 配列にメッセージを追加:

```php
$sample_messages = array(
    '本日のテニススクールは開催します。',
    // ここに新しいメッセージを追加
);
```

## トラブルシューティング

### 通知が表示されない

1. プラグインが有効化されているか確認
2. ショートコードが正しく記述されているか確認
3. 通知の日付が正しく設定されているか確認
4. ブラウザのキャッシュをクリア

### スタイルが反映されない

1. ブラウザのキャッシュをクリア
2. テーマのCSSと競合していないか確認
3. 開発者ツールでCSSが読み込まれているか確認

### カレンダーが表示されない

1. jQuery UI が正しく読み込まれているか確認
2. 他のプラグインとの競合がないか確認
3. ブラウザのコンソールエラーを確認

## アンインストール

プラグインを削除すると、保存されたデータは残ります。
完全に削除したい場合は、プラグインファイル内の `tsn_uninstall_plugin()` 関数のコメントアウトを解除してください。

## バージョン履歴

### Version 1.0.0
- 初回リリース
- 基本機能の実装
- 管理画面の実装
- ショートコード機能の実装

## ライセンス

GPL v2 or later

## サポート

質問や問題がある場合は、大森テニスクラブまでお問い合わせください。

## 開発者情報

- **プラグイン名**: テニススクール開催連絡
- **バージョン**: 1.0.0
- **作者**: 大森テニスクラブ
- **必須WordPressバージョン**: 5.0以上
- **テスト済みWordPressバージョン**: 6.4